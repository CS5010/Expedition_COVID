2022-11-27 15:39:28.646739: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F AVX512_VNNI FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-11-27 15:39:28.776838: I tensorflow/core/util/util.cc:169] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2022-11-27 15:39:28.808976: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2022-11-27 15:39:30.132044: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/centos-7.4/anaconda3/current/lib:/u/mi3se/anaconda3/envs/ml/lib/:/u/mi3se/anaconda3/envs/ml/lib
2022-11-27 15:39:30.132112: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/centos-7.4/anaconda3/current/lib:/u/mi3se/anaconda3/envs/ml/lib/:/u/mi3se/anaconda3/envs/ml/lib
2022-11-27 15:39:30.132118: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2022-11-27 15:44:19.998663: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F AVX512_VNNI FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-11-27 15:44:20.322449: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 13199 MB memory:  -> device: 0, name: NVIDIA A16, pci bus id: 0000:d1:00.0, compute capability: 8.6
Shapes: train (2296802, 14), validation (94260, 14), test (94260, 14).
Shapes: data (2211968, 13, 10), labels (2211968, 15).
Shapes: data (9426, 13, 10), labels (9426, 15).
Shapes: data (9426, 13, 10), labels (9426, 15).

----Training started at 2022-11-27 15:44:22.420120----

Epoch 1/200
2022-11-27 15:44:28.940860: I tensorflow/stream_executor/cuda/cuda_dnn.cc:384] Loaded cuDNN version 8201
2022-11-27 15:44:29.771981: I tensorflow/stream_executor/cuda/cuda_blas.cc:1614] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
17281/17281 - 115s - loss: 1.0028 - val_loss: 0.1381 - 115s/epoch - 7ms/step
Epoch 2/200
17281/17281 - 105s - loss: 0.9177 - val_loss: 0.1155 - 105s/epoch - 6ms/step
Epoch 3/200
17281/17281 - 105s - loss: 0.8431 - val_loss: 0.1188 - 105s/epoch - 6ms/step
Epoch 4/200
17281/17281 - 105s - loss: 0.8009 - val_loss: 0.1204 - 105s/epoch - 6ms/step
Epoch 5/200
17281/17281 - 105s - loss: 0.7688 - val_loss: 0.1218 - 105s/epoch - 6ms/step
Epoch 6/200
17281/17281 - 105s - loss: 0.7414 - val_loss: 0.1238 - 105s/epoch - 6ms/step
Epoch 7/200
17281/17281 - 105s - loss: 0.7175 - val_loss: 0.1258 - 105s/epoch - 6ms/step

----Training ended at 2022-11-27 15:56:48.405951, elapsed time 0:12:25.985831.
Best model by validation loss saved at results_BiLSTM_split_3/model.h5.
Loading best model.

Train prediction
17281/17281 - 50s - 50s/epoch - 3ms/step
               FIPS         Cases  Predicted_Cases
count  2.249672e+06  2.249672e+06     2.249672e+06
mean   3.038365e+04  2.926275e+01     2.220266e+01
std    1.516010e+04  1.814576e+02     4.212342e+01
min    1.001000e+03  0.000000e+00     0.000000e+00
25%    1.817700e+04  0.000000e+00     1.000000e+00
50%    2.917600e+04  2.000000e+00     8.000000e+00
75%    4.508100e+04  1.300000e+01     2.200000e+01
max    5.604500e+04  2.061825e+04     3.040000e+02
Target Cases, MAE 22.996, RMSE 165.29, RMSLE 1.4287, SMAPE 0.9507. NNSE 0.54653.


Validation prediction
74/74 - 0s - 225ms/epoch - 3ms/step
               FIPS         Cases  Predicted_Cases
count  47130.000000  47130.000000     47130.000000
mean   30383.649268     11.205103        21.461871
std    15160.256142     62.660459        35.745541
min     1001.000000      0.000000         0.000000
25%    18177.000000      0.000000         2.000000
50%    29176.000000      0.000000        11.000000
75%    45081.000000      5.000000        23.000000
max    56045.000000   4467.000000       385.000000
Target Cases, MAE 18.397, RMSE 57.635, RMSLE 1.9015, SMAPE 1.2464. NNSE 0.54169.


Test prediction
74/74 - 0s - 238ms/epoch - 3ms/step
               FIPS         Cases  Predicted_Cases
count  47130.000000  47130.000000     47130.000000
mean   30383.649268      9.437428        15.377764
std    15160.256142     94.176476        25.597733
min     1001.000000      0.000000         0.000000
25%    18177.000000      0.000000         1.000000
50%    29176.000000      0.000000         9.000000
75%    45081.000000      2.000000        18.000000
max    56045.000000   8467.000000       382.000000
Target Cases, MAE 15.555, RMSE 89.48, RMSLE 1.8862, SMAPE 1.3046. NNSE 0.52555.

Ended at 2022-11-27 16:17:16.823844. Elapsed time 0:32:54.403760
